# 数值分析<3>——任意曲线拟合

## 全文目录

[（博客园）机器学习](https://www.cnblogs.com/WarrenRyan/p/12503734.html)

[（Github）MachineLearning Math](https://github.com/StevenEco/MachineLearning-Math)


## 大杀器！泰勒展开公式

你是否想过这样一个问题，任何的函数，也许都能通过一个“大一统”理论将他们整合在一起。事实上对于任意一种对应关系，我们都能找到一个函数尽可能去贴合它，我们采取的是一种极限的思维，举个不恰当的例子来描述，如果一个东西看起来像牛粪，闻起来像牛粪，尝起来像牛粪，那么它就是牛粪。并且，更加一般的是，在一个微小的区间内，函数还可以写成一个幂函数的形式去大致的估算。

泰勒定理给了我们一个很通用的方法去研究函数：

设n是一个正整数。如果定义在一个包含a的区间上的函数$f$在a点处n+1次可导，那么对于这个区间上的任意x，都有：

$$
f(x)=\sum^{n}_{i=0}\frac{f^{(i)}(a)}{i!}(x-1)^i+R_n(x)
$$

其中，上式的$R_n(x)$是泰勒公式的估计余项，这在后续会进行详细的解释。

如果仅仅只是背下来，你就不能领略到泰勒展开的精妙之处了。我们用一些很精妙的手段，自然的推导出泰勒公式。首先我们先假定一个函数存在一阶导函数，来看一看一阶导数的定义

$$
\lim_{x\to x_0}\frac{f(x)-f(x_0)}{x-x_0}=f^{'}(x_0)
$$

其实从这里不难发现，导数定义上，给了我们一种当$x\to x_0$的时候，计算$f(x)$的手段，我们假定这个过程的无穷小为$\alpha(x)(x\to x_0)$，那么我们可以把这个等式改写为如下形式

$$
\lim_{x\to x_0} = f(x) = L \Leftrightarrow f(x) = L+\alpha(x)
\\
\\
\lim_{x\to x_0}f^{'}(x) = \frac{f(x)-f(x_0)}{x-x_0} = f^{'}(x)+\alpha(x)
\\
\\
f(x) = f(x_0)+f^{'}(x_0)(x-x_0)+\alpha(x)\times(x-x_0)
\\
\\
=f(x_0)+f^{'}(x_0)(x-x_0)+\omicron(x-x_0)
$$

### 余项估计

从上面的推导规程很明显可以看出最后一项无穷小是$(x-x_0)$的高阶无穷小，所以我们就很自然的得出了$f(x)$的一阶泰勒展开式。利用这个公式，我们可以去拟合任意可导的函数的任意函数点，再从点的绘制成函数曲线。

当然我们会认为，一阶导数所带来的那个余项无穷小是不够精确的，提高精确值的方法就是让这个无穷小的阶升高，那么我们可以继续考虑二阶展开，让这个无穷小的阶数升高。首先我们来单独的研究一下这个无穷小。

$$
\omicron(x-x_0) = f(x)-f(x_0)-f^{'}(x_0)(x-x_0)
\\
\\
\lim_{x\to x_0}\frac{\omicron(x-x_0)}{(x-x_0)^2} = \lim_{x\to x_0}\frac{f(x)-f(x_0)-f^{'}(x_0)(x-x_0)}{(x-x_0)^2}
$$

很明显，只要我们的函数二阶可导，那么上述式子就满足了0/0型的洛必达法则！那么我们直接开始洛必达！

$$
\lim_{x\to x_0}\frac{f(x)-f(x_0)-f^{'}(x_0)(x-x_0)}{(x-x_0)^2} = \lim_{x\to x_0}\frac{f^{'}(x)-f^{'}(x_0)}{2(x-x_0)}
\\
\\
=\frac{1}{2}f^{''}(x_0) = \lim_{x\to x_0}\frac{\omicron(x-x_0)}{(x-x_0)^2} \Leftrightarrow \omicron(x-x_0) = \frac{1}{2}f^{''}(x_0)(x-x_0)^2
\\
\\
\Leftrightarrow f(x) = f(x_0)+f^{'}(x_0)(x-x_0)+\frac{1}{2}f^{''}(x_0)(x-x_0)^2 +\omicron(x-x_0)^2
$$

这样，我们就得到了拥有二阶无穷小的泰勒公式！如法炮制，只要我们的$f(x)$在$x_0$满足n阶可导的情况，那么我们就可以一直用上面的方式得到n阶泰勒展开公式。


接下来我们来估计余项，也就是误差的大小。在上面的推断中，我们一直使用无穷小进行误差的估计，这种类型的余项叫做皮亚诺余项，这种好处是可以很直观的看出误差的阶数，但是并不算是一个特别容易计算的值，我们仅仅知道最大的误差不超过$\omicron(x-x_0)^n$。因此我们可以思考一下，假如我们展开到第n阶的时候，误差必然是比第n+1阶新引入的那一项更大，但比第n阶是更小的，那么我们可以用介值定理和拉格朗日微分中值定理进行推广，那么余项可以写成

$$
R_n(x) = \frac{f^{(n+1)}(\theta)}{n!}(x-x_0)^{n+1}
$$

利用泰勒公式，我们就可以将一个可导函数的任意点进行一个拟合，从而得到一个较为精确的结果，从函数图像上看，泰勒公式是一个级数累加不断前进逼近的过程。

## 插值法

如果针对的是一个有穷数列，例如请你寻找以下数字的规律并填写接下来的数字

- 4、7、11、18、29、47、(__)

你的第一眼可能会发现这是一个类似 *Fibonacci数列*的规律数字，但实际上我们对于有穷离散型函数，也可以推出这样一个奇怪的对应关系

$$
a_x=\frac {28579 x^9}{90720} - \frac{142847 x^8}{10080} + \frac{4140931 x^7}{15120} - \frac{713627 x^6}{240} + \frac{17192243 x^5}{864} - \frac{40631363 x^4}{480} + \frac{644406697 x^3}{2835} - \frac{927568429 x^2}{2520} +\frac {101426987 x}{315} - 113739
$$

并且对于任何的有穷的数列，我们总是能使用一个通项公式进行数据的拟合计算。如果我们把上述拓展到函数领域，也就是对于任意有限多的$(x_i,y_i)$，且这些点符合函数的规则，每个x对应唯一的y，我们总能用一个连续的多项式组合的函数，保证这个函数经过上面所有的点，而计算这个多项式的过程，我们就称为插值。插值是求值的逆过程，

### 拉格朗日插值

### Aitken（埃特金）插值

### 分段插值法

### Newton（牛顿）插值

### Hermite(埃尔米特)插值

### 切比雪夫插值法

## 插值的误差分析

## 曲线拟合法

### 直线拟合

### 展开式拟合

### 指对数拟合

### 三次样条

## 习题
